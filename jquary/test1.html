<HTML>

<HEAD>
    <TITLE>WMI Scripting HTML</TITLE>
    <META http-equiv=Content-Type content="text/html; charset=gb2312">
    <SCRIPT language=JScript event="OnCompleted(hResult,pErrorObject, pAsyncContext)" for=foo>
        document.forms[0].txtMACAddr.value = unescape(MACAddr);
        document.forms[0].txtIPAddr.value = unescape(IPAddr);
        document.forms[0].txtDNSName.value = unescape(sDNSName);
    </SCRIPT>

    <SCRIPT language=JScript event=OnObjectReady(objObject,objAsyncContext) for=foo>
        if (objObject.IPEnabled != null && objObject.IPEnabled != "undefined" && objObject.IPEnabled == true) {
            if (objObject.MACAddress != null && objObject.MACAddress != "undefined")
                MACAddr = objObject.MACAddress;
            if (objObject.IPEnabled && objObject.IPAddress(0) != null && objObject.IPAddress(0) != "undefined")
                IPAddr = objObject.IPAddress(0);
            if (objObject.DNSHostName != null && objObject.DNSHostName != "undefined")
                sDNSName = objObject.DNSHostName;
        }
    </SCRIPT>

    <META content="Microsoft FrontPage 4.0" name=GENERATOR>
</HEAD>

<BODY>
    <OBJECT id=locator classid=CLSID:76A64158-CB41-11D1-8B02-00600806D9B6 VIEWASTEXT></OBJECT>
    <OBJECT id=foo classid=CLSID:75718C9A-F029-11d1-A1AC-00C04FB6C223></OBJECT>
    <SCRIPT language=JScript>
        var MACAddr;
        var IPAddr;
        var sDNSName;
        var service = locator.ConnectServer();
        service.Security_.ImpersonationLevel = 3;
        service.InstancesOfAsync(foo, 'Win32_NetworkAdapterConfiguration');
    </SCRIPT>

    <FORM id=formfoo name=formbar action=m ethod=post>
        <INPUT value="" name=txtMACAddr>
        <INPUT value="" name=txtIPAddr>
        <INPUT value="" name=txtDNSName>
    </FORM>
</BODY>

</HTML>